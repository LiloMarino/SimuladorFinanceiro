"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[1776],{9199(e,s,n){n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"desenvolvimento/ciclo-banco-dados","title":"Ciclo de Desenvolvimento com Banco de Dados","description":"O ciclo de desenvolvimento do projeto \xe9 feito exclusivamente com PostgreSQL.","source":"@site/docs/desenvolvimento/ciclo-banco-dados.md","sourceDirName":"desenvolvimento","slug":"/desenvolvimento/ciclo-banco-dados","permalink":"/SimuladorFinanceiro/desenvolvimento/ciclo-banco-dados","draft":false,"unlisted":false,"editUrl":"https://github.com/LiloMarino/SimuladorFinanceiro/tree/main/docs/docs/desenvolvimento/ciclo-banco-dados.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Estrutura de Pastas","permalink":"/SimuladorFinanceiro/desenvolvimento/estrutura-pastas"},"next":{"title":"Diretrizes Async vs Sync","permalink":"/SimuladorFinanceiro/desenvolvimento/async-vs-sync"}}');var a=n(2615),i=n(5756);const r={sidebar_position:4},l="Ciclo de Desenvolvimento com Banco de Dados",d={},c=[{value:"Configura\xe7\xe3o do Banco de Dados (PostgreSQL)",id:"configura\xe7\xe3o-do-banco-de-dados-postgresql",level:2},{value:"Ciclo de Desenvolvimento",id:"ciclo-de-desenvolvimento",level:2},{value:"Passo 1: Editar o Schema no PostgreSQL",id:"passo-1-editar-o-schema-no-postgresql",level:3},{value:"Op\xe7\xe3o A: Ferramentas gr\xe1ficas",id:"op\xe7\xe3o-a-ferramentas-gr\xe1ficas",level:4},{value:"Op\xe7\xe3o B: SQL manual",id:"op\xe7\xe3o-b-sql-manual",level:4},{value:"Passo 2: Sincronizar o banco local",id:"passo-2-sincronizar-o-banco-local",level:3},{value:"Passo 3: Gerar ORM com <code>sqlacodegen</code>",id:"passo-3-gerar-orm-com-sqlacodegen",level:3},{value:"Cria\xe7\xe3o Autom\xe1tica de Tabelas",id:"cria\xe7\xe3o-autom\xe1tica-de-tabelas",level:2},{value:"Dicas e Boas Pr\xe1ticas",id:"dicas-e-boas-pr\xe1ticas",level:2},{value:"Evite SQL Raw",id:"evite-sql-raw",level:3},{value:"Pr\xf3ximos Passos",id:"pr\xf3ximos-passos",level:2}];function t(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"ciclo-de-desenvolvimento-com-banco-de-dados",children:"Ciclo de Desenvolvimento com Banco de Dados"})}),"\n",(0,a.jsxs)(s.p,{children:["O ciclo de desenvolvimento do projeto \xe9 feito ",(0,a.jsx)(s.strong,{children:"exclusivamente com PostgreSQL"}),"."]}),"\n",(0,a.jsxs)(s.p,{children:["Durante o desenvolvimento, ",(0,a.jsx)(s.strong,{children:"o PostgreSQL \xe9 tratado como o banco can\xf4nico"}),"."]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"configura\xe7\xe3o-do-banco-de-dados-postgresql",children:"Configura\xe7\xe3o do Banco de Dados (PostgreSQL)"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Instalar PostgreSQL:"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Windows: ",(0,a.jsx)(s.a,{href:"https://www.postgresql.org/download/windows/",children:"https://www.postgresql.org/download/windows/"})]}),"\n",(0,a.jsxs)(s.li,{children:["Linux: ",(0,a.jsx)(s.code,{children:"sudo apt install postgresql"})]}),"\n",(0,a.jsxs)(s.li,{children:["macOS: ",(0,a.jsx)(s.code,{children:"brew install postgresql"})]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Criar banco de dados:"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-sql",children:"CREATE DATABASE simulador_financeiro;\n"})}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsx)(s.p,{children:(0,a.jsxs)(s.strong,{children:["Configurar ",(0,a.jsx)(s.code,{children:".env"}),":"]})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-env",children:"POSTGRES_DATABASE_URL=postgresql+psycopg://postgres:sua_senha@localhost:5432/simulador_financeiro\n"})}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Iniciar a aplica\xe7\xe3o:"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"python main.py\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"As tabelas ser\xe3o criadas automaticamente se n\xe3o existirem."}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"ciclo-de-desenvolvimento",children:"Ciclo de Desenvolvimento"}),"\n",(0,a.jsx)(s.p,{children:"O fluxo de trabalho para altera\xe7\xf5es no banco de dados \xe9:"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:["\u270f\ufe0f ",(0,a.jsx)(s.strong,{children:"Editar o schema no PostgreSQL"})," (via ferramenta gr\xe1fica ou SQL manual)"]}),"\n",(0,a.jsxs)(s.li,{children:["\ud83d\udce5 ",(0,a.jsx)(s.strong,{children:"Sincronizar o banco local"})," (tabelas e rela\xe7\xf5es atualizadas)"]}),"\n",(0,a.jsxs)(s.li,{children:["\ud83e\uddec ",(0,a.jsxs)(s.strong,{children:["Gerar modelos ORM com ",(0,a.jsx)(s.code,{children:"sqlacodegen"})]})," (quando fizer sentido)"]}),"\n",(0,a.jsxs)(s.li,{children:["\ud83d\udee0\ufe0f ",(0,a.jsx)(s.strong,{children:"Ajustar modelos manualmente"})," quando a altera\xe7\xe3o for pequena"]}),"\n"]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"passo-1-editar-o-schema-no-postgresql",children:"Passo 1: Editar o Schema no PostgreSQL"}),"\n",(0,a.jsxs)(s.p,{children:["Voc\xea pode editar o schema usando ferramentas como ",(0,a.jsx)(s.strong,{children:"pgAdmin"})," ou ",(0,a.jsx)(s.strong,{children:"DataGrip"}),", ou editar manualmente via SQL."]}),"\n",(0,a.jsx)(s.h4,{id:"op\xe7\xe3o-a-ferramentas-gr\xe1ficas",children:"Op\xe7\xe3o A: Ferramentas gr\xe1ficas"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsx)(s.li,{children:"Edite as tabelas, colunas e rela\xe7\xf5es na ferramenta"}),"\n",(0,a.jsx)(s.li,{children:"Aplique as mudan\xe7as no banco local"}),"\n"]}),"\n",(0,a.jsx)(s.h4,{id:"op\xe7\xe3o-b-sql-manual",children:"Op\xe7\xe3o B: SQL manual"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsx)(s.li,{children:"Edite o SQL das tabelas e rela\xe7\xf5es"}),"\n",(0,a.jsx)(s.li,{children:"Execute os comandos diretamente no banco local"}),"\n"]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"passo-2-sincronizar-o-banco-local",children:"Passo 2: Sincronizar o banco local"}),"\n",(0,a.jsx)(s.p,{children:"Se as altera\xe7\xf5es foram feitas via ferramenta gr\xe1fica, elas j\xe1 s\xe3o aplicadas no banco local."}),"\n",(0,a.jsx)(s.p,{children:"Se foram feitas manualmente, execute os scripts SQL:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"psql -U postgres -d simulador_financeiro -f schema_changes.sql\n"})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsxs)(s.h3,{id:"passo-3-gerar-orm-com-sqlacodegen",children:["Passo 3: Gerar ORM com ",(0,a.jsx)(s.code,{children:"sqlacodegen"})]}),"\n",(0,a.jsxs)(s.p,{children:["O ",(0,a.jsx)(s.code,{children:"sqlacodegen"})," l\xea o schema existente no banco de dados e gera automaticamente os modelos SQLAlchemy."]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Instala\xe7\xe3o:"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"pip install sqlacodegen\n"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Gerar modelos:"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"sqlacodegen postgresql+psycopg://postgres:<senha>@localhost:5432/simulador_financeiro > backend/core/models/models.py\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Substitua ",(0,a.jsx)(s.code,{children:"<senha>"})," pela senha do seu banco PostgreSQL."]}),"\n",(0,a.jsx)(s.admonition,{title:"Quando usar sqlacodegen",type:"tip",children:(0,a.jsxs)(s.p,{children:["O ",(0,a.jsx)(s.code,{children:"sqlacodegen"})," \xe9 mais \xfatil quando h\xe1 ",(0,a.jsx)(s.strong,{children:"mudan\xe7as grandes no schema"}),".\nPara altera\xe7\xf5es pequenas, normalmente \xe9 melhor editar diretamente o arquivo  ",(0,a.jsx)(s.code,{children:"backend/core/models/models.py"}),"."]})}),"\n",(0,a.jsxs)(s.admonition,{title:"C\xf3digo gerado n\xe3o \xe9 final",type:"warning",children:[(0,a.jsxs)(s.p,{children:["O c\xf3digo gerado pelo ",(0,a.jsx)(s.code,{children:"sqlacodegen"})," ",(0,a.jsx)(s.strong,{children:"serve como ponto de partida e deve ser revisado."}),"."]}),(0,a.jsx)(s.p,{children:"\xc9 comum ajustar manualmente:"}),(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Relacionamentos"}),"\n",(0,a.jsx)(s.li,{children:"Enums"}),"\n",(0,a.jsx)(s.li,{children:"Tipos customizados"}),"\n",(0,a.jsx)(s.li,{children:"Defaults e constraints"}),"\n"]})]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"cria\xe7\xe3o-autom\xe1tica-de-tabelas",children:"Cria\xe7\xe3o Autom\xe1tica de Tabelas"}),"\n",(0,a.jsxs)(s.p,{children:["O projeto cria automaticamente as tabelas ",(0,a.jsx)(s.strong,{children:"em ambientes limpos ou no primeiro run"}),", com base nos modelos ORM:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"Base.metadata.create_all(bind=engine)\n"})}),"\n",(0,a.jsx)(s.p,{children:"Isso \xe9 \xfatil para:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Primeiro setup"}),"\n",(0,a.jsx)(s.li,{children:"Ambientes de teste"}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["No desenvolvimento cont\xednuo com PostgreSQL, o schema deve ser tratado como ",(0,a.jsx)(s.strong,{children:"database-first"}),"."]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"dicas-e-boas-pr\xe1ticas",children:"Dicas e Boas Pr\xe1ticas"}),"\n",(0,a.jsx)(s.h3,{id:"evite-sql-raw",children:"Evite SQL Raw"}),"\n",(0,a.jsx)(s.p,{children:"Sempre que poss\xedvel, use o ORM do SQLAlchemy."}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Evite:"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'session.execute("SELECT * FROM users WHERE id = 1")\n'})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Prefira:"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"session.get(User, 1)\n"})}),"\n",(0,a.jsx)(s.p,{children:"ou, em consultas mais complexas:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"stmt = select(User).where(User.id == 1)\nsession.execute(stmt).scalar_one_or_none()\n"})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"pr\xf3ximos-passos",children:"Pr\xf3ximos Passos"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"/SimuladorFinanceiro/desenvolvimento/async-vs-sync",children:"Diretrizes Async vs Sync"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"/SimuladorFinanceiro/desenvolvimento/estrutura-pastas",children:"Estrutura de Pastas"})}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(t,{...e})}):t(e)}}}]);